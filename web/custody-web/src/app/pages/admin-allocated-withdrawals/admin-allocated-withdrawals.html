<div style="max-width:1100px; margin:24px auto; font-family:system-ui;">
  <h2>Admin — Allocated Withdrawal Queue (PENDING)</h2>

  <p *ngIf="error" style="color:#b00020;">{{ error }}</p>
  <p *ngIf="actionMsg" style="color:#0b6b0b;">{{ actionMsg }}</p>

  <table style="width:100%; border-collapse:collapse;">
    <thead>
      <tr style="text-align:left; border-bottom:1px solid #eee;">
        <th>ID</th>
        <th>Reference</th>
        <th>Qty (kg)</th>
        <th>Bars</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let w of items" style="border-bottom:1px solid #f2f2f2;">
        <td>{{ w.id }}</td>
        <td>{{ w.reference }}</td>
        <td>{{ w.quantity_kg }}</td>

        <td>
          <div *ngIf="w.bars?.length; else noBars">
            <div *ngFor="let b of w.bars">
              <b>{{ b.serial }}</b> — {{ b.weight_kg }} kg — {{ b.vault ?? '-' }} — {{ b.status }}
            </div>
          </div>
          <ng-template #noBars>-</ng-template>
        </td>

        <td>{{ w.status }}</td>

        <td>
          <button style="padding:8px 10px; margin-right:8px" (click)="approve(w.id)">Approve</button>
          <button style="padding:8px 10px" (click)="reject(w.id)">Reject</button>
        </td>
      </tr>

      <tr *ngIf="items.length === 0">
        <td colspan="6" style="padding:12px; color:#666;">No pending allocated withdrawals.</td>
      </tr>
    </tbody>
  </table>

  <button style="margin-top:12px; padding:10px 14px" (click)="refresh()">Refresh</button>
</div>
